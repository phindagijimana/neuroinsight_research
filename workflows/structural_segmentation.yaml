# Workflow 2: FastSurfer Segmentation and Volumetry
id: structural_segmentation
name: "FastSurfer Segmentation and Volumetry"
version: "1.0.0"
type: workflow
domain: structural_mri

description: >
  Fast structural MRI segmentation using FastSurfer deep learning.
  Produces cortical parcellation, subcortical volumes, and surface
  reconstruction. FreeSurfer-compatible outputs.

developer_contract: >
  Workflows only orchestrate plugins. No direct execution steps allowed.

inputs:
  required:
    - key: T1w
      type: nifti
      description: "T1-weighted MRI scan"
  optional:
    - key: subject_id
      type: string
      default: "subject"
    - key: fs_license
      type: path

validation:
  preflight_checks:
    - "file_exists(T1w)"
    - "is_nifti(T1w)"

steps:
  - id: fastsurfer
    uses: fastsurfer
    with:
      T1w: "{inputs.T1w}"
      subject_id: "{inputs.subject_id}"
      fs_license: "{inputs.fs_license}"

outputs:
  native:
    - "{run_root}/native/fastsurfer"
  bundle:
    - "{run_root}/bundle"

reproducibility:
  pin_containers: true
  write_run_manifest: true
  store_exact_commands: true
